df <- data.frame()
for (proj in c(73, 82)) {
for (sample in c("encyclo", "kappa-hf-taq", "phusion", "sd-hs", "snp-detect",
"taq-hs", "tersus", "tersus-snp-buff", "truseq", "velox")) {
.df <- read.table(paste("polerr", proj, ".", sample, ".variant.caller.txt", sep=""),
header=T, sep="\t", stringsAsFactors = F)
.df$proj <- proj
.df$sample <- sample
df <- rbind(df, .df)
}
}
df <- subset(df, freq < 0.5 & !grepl("D", mutation) & !grepl("I", mutation))
setwd("D:/Work/2016/mageri/polerr")
df <- data.frame()
for (proj in c(73, 82)) {
for (sample in c("encyclo", "kappa-hf-taq", "phusion", "sd-hs", "snp-detect",
"taq-hs", "tersus", "tersus-snp-buff", "truseq", "velox")) {
.df <- read.table(paste("polerr", proj, ".", sample, ".variant.caller.txt", sep=""),
header=T, sep="\t", stringsAsFactors = F)
.df$proj <- proj
.df$sample <- sample
df <- rbind(df, .df)
}
}
df <- subset(df, freq < 0.5 & !grepl("D", mutation) & !grepl("I", mutation))
ggplot(df, aes(freq, error.rate)) + geom_point() +
geom_smooth(method="lm") + scale_x_log10() + scale_y_log10()
cor(df$freq, df$error.rate, method = "spearman")
library(ggplot2)
ggplot(df, aes(freq, error.rate)) + geom_point() +
geom_smooth(method="lm") + scale_x_log10() + scale_y_log10()
cor(df$freq, df$error.rate, method = "spearman")
library(ggplot2)
ggplot(df, aes(freq, error.rate)) + geom_point() +
geom_smooth(data = subset(df, freq >0), method="lm") +
scale_x_log10(limits=c(1e-6,1e-2)) + scale_y_log10(limits=c(1e-6,1e-2)) +
theme_bw()
cor(df$freq, df$error.rate, method = "spearman")
str(df)
df <- data.frame()
for (proj in c(73, 82)) {
for (sample in c("encyclo", "kappa-hf-taq", "phusion", "sd-hs", "snp-detect",
"taq-hs", "tersus", "tersus-snp-buff", "truseq", "velox")) {
.df <- read.table(paste("polerr", proj, ".", sample, ".variant.caller.txt", sep=""),
header=T, sep="\t", stringsAsFactors = F)
.df$proj <- proj
.df$sample <- sample
df <- rbind(df, .df)
}
}
df <- subset(df, freq < 0.5 & !grepl("D", mutation) & !grepl("I", mutation) & global.est == 0)
library(ggplot2)
ggplot(df, aes(freq, error.rate)) + geom_point() +
geom_smooth(data = subset(df, freq >0), method="lm") +
scale_x_log10(limits=c(1e-6,1e-2)) + scale_y_log10(limits=c(1e-6,1e-2)) +
theme_bw()
cor(df$freq, df$error.rate, method = "spearman")
with(subset(df, freq >0),
cor(freq, error.rate, method = "spearman"))
ggplot(df, aes(freq, error.rate)) + geom_point() +
scale_x_log10(limits=c(1e-6,1e-2)) + scale_y_log10(limits=c(1e-6,1e-2)) +
theme_bw()
ggplot(df, aes(freq, error.rate)) + geom_point(shape=21) +
scale_x_log10(limits=c(1e-6,1e-2)) + scale_y_log10(limits=c(1e-6,1e-2)) +
theme_bw()
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
mdl <- glm(count ~ coverage +
I((1.0 - minor.fdr) * minor.count.local) +
read.fraction.in.minors, df, family=poisson())
summary(mdl)
View(df)
str(df)
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors + q.filtered.read.fraction, df, family=poisson())
summary(mdl)
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction), df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
str(df)
ggplot(df, aes(count, count.fit)) + geom_point()
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction), df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction), df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
#mdl <- glm(count ~ coverage +
#             minor.count.local +
#             read.fraction.in.minors +
#             I(1.0 - q.filtered.read.fraction), df, family=poisson())
mdl <- glm(count ~ coverage + error.rate), df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
#mdl <- glm(count ~ coverage +
#             minor.count.local +
#             read.fraction.in.minors +
#             I(1.0 - q.filtered.read.fraction), df, family=poisson())
mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
str(df$count)
#mdl <- glm(count ~ coverage +
#             minor.count.local +
#             read.fraction.in.minors +
#             I(1.0 - q.filtered.read.fraction), df, family=poisson())
mdl <- glm(count ~ coverage + error.rate - 1, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
#mdl <- glm(count ~ coverage +
#             minor.count.local +
#             read.fraction.in.minors +
#             I(1.0 - q.filtered.read.fraction), df, family=poisson())
mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_wrap(~sample)+
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction), df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
df <- data.frame()
for (proj in c(73, 82)) {
for (sample in c("encyclo", "kappa-hf-taq", "phusion", "sd-hs", "snp-detect",
"taq-hs", "tersus", "tersus-snp-buff", "truseq", "velox")) {
.df <- read.table(paste("polerr", proj, ".", sample, ".variant.caller.txt", sep=""),
header=T, sep="\t", stringsAsFactors = F)
.df$proj <- proj
.df$sample <- sample
df <- rbind(df, .df)
}
}
df <- subset(df, freq < 0.5 & !grepl("D", mutation) & !grepl("I", mutation) & global.est == 0)
df$mut.split <- sapply(df$mutation, function(x) strsplit(as.character(x),"[S:>]"))
df$mutation.pos <- as.integer(sapply(df$mut.split, function(x) x[2]))
df$mutation.from <- sapply(df$mut.split, function(x) x[3])
df$mutation.to <- sapply(df$mut.split, function(x) x[4])
df$mut.split  <- NULL
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_wrap(~sample) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_wrap(mutation.from+mutation.to~sample) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from+mutation.to~sample) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from + mutation.to,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from + mutation.to,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10() + scale_y_log10()
mdl <- glm(count ~ coverage +
minor.count.local +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from + mutation.to,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from+mutation.to~sample) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
mdl <- glm(count ~ coverage +
minor.count.local + minor.count.global +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from + mutation.to,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
mdl <- glm(count ~ coverage +
minor.count.local + minor.count.global +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from + mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
mdl <- glm(count ~ coverage +
minor.count.local + minor.count.global +
read.fraction.in.minors +
I(1.0 - q.filtered.read.fraction) + mutation.from:mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from+mutation.to~sample) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(freq, error.rate)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from~mutation.to) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(freq, error.rate, color=proj)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from~mutation.to) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
str(df)
library(ggplot2)
ggplot(df, aes(x=freq, y=error.rate, color=sample)) +
geom_point(shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from~mutation.to) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
library(ggplot2)
ggplot(df, aes(x=freq, y=error.rate)) +
geom_point(aes(color=sample), shape=21) +
geom_smooth(data=subset(df, freq > 0), method="lm") +
scale_x_log10(limits=c(1e-6, 1e-2)) +
scale_y_log10(limits=c(1e-6, 1e-2)) + facet_grid(mutation.from~mutation.to) +
theme_bw()
with(subset(df, freq > 0), cor(freq, error.rate, method = "spearman"))
mdl <- glm(count ~ coverage + error.rate +
I(1.0 - q.filtered.read.fraction) + mutation.from:mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
mdl <- glm(count ~ coverage + error.rate +
I(1.0 - q.filtered.read.fraction) + mutation.from:mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(count, count.fit)) + geom_point() + geom_density() +
scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
mdl <- glm(count ~ coverage + error.rate +
I(1.0 - q.filtered.read.fraction) + mutation.from:mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(x=count, y=count.fit)) + geom_point() + geom_density2d() +
scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
mdl <- glm(count ~ coverage + error.rate + fdr + recall +
I(1.0 - q.filtered.read.fraction) + mutation.from:mutation.to - 1,
df, family=poisson())
#mdl <- glm(count ~ coverage + error.rate, df, family=poisson())
summary(mdl)
df$count.fit <- fitted.values(mdl)
ggplot(df, aes(x=count, y=count.fit)) + geom_point() + geom_density2d() +
scale_x_log10(limits=c(1, 1000)) + scale_y_log10(limits=c(1, 1000))
